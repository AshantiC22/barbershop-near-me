// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           String        @id @default(uuid())
  email        String        @unique
  name         String
  role         Role          @default(CLIENT)
  appointments Appointment[]
  createdAt    DateTime      @default(now())
}

model Barber {
  id           String        @id @default(uuid())
  name         String
  bio          String
  imageUrl     String?
  appointments Appointment[]
}

model Service {
  id           String        @id @default(uuid())
  name         String
  price        Int // Stored in cents (e.g., 2500 = $25.00)
  duration     Int // In minutes
  appointments Appointment[]
}

model Appointment {
  id        String            @id @default(uuid())
  startTime DateTime
  endTime   DateTime
  status    AppointmentStatus @default(PENDING)

  userId String
  user   User   @relation(fields: [userId], references: [id])

  barberId String
  barber   Barber @relation(fields: [barberId], references: [id])

  serviceId String
  service   Service @relation(fields: [serviceId], references: [id])

  @@unique([barberId, startTime]) // The "Secret Sauce": Prevents double-booking!
}

enum Role {
  CLIENT
  ADMIN
}

enum AppointmentStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}
